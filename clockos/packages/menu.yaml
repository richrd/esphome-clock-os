################################################################
# Menu
################################################################
graphical_display_menu:
  id: main_menu
  display: clockos_display
  active: false
  on_redraw:
    then:
      component.update: clockos_display
  font: font_menu
  mode: rotary
  menu_item_value: !lambda |-
    // Customize menu value editing visuals
    std::string label = " ";
    if (it->is_item_selected && it->is_menu_editing) {
      label.append(" - ");
      label.append(it->item->get_value_text());
      label.append(" + ");
    } else {
      label.append("[");
      label.append(it->item->get_value_text());
      label.append("]");
    }
    return label;
  items:
    - type: menu
      text: ' Clock ⏵ '
      id: menu_submenu_clock
      items:
      - type: back
        text: ' ⏴ Back '
    - type: menu
      text: ' Games ⏵ '
      id: menu_submenu_games
      items:
        - type: back
          text: ' ⏴ Back '
        - type: command
          text: !lambda |-
            return std::string(" Autoplay [") + (id(clockos_global_game_autoplay) ? "ON" : "OFF") + "]";
          on_value:
            then:
              - if:
                  condition:
                    lambda: 'return id(clockos_global_game_autoplay);'
                  then:
                    - switch.turn_off: clockos_switch_game_autoplay
                  else:
                    - switch.turn_on: clockos_switch_game_autoplay
        - type: menu
          id: menu_submenu_demos
          text: ' Demos ⏵ '
          items:
            - type: back
              text: ' ⏴ Back '
    - type: menu
      text: ' Sounds ⏵ '
      id: menu_submenu_sounds
      items:
        - type: back
          text: ' ⏴ Back '
    - type: menu
      id: menu_submenu_control
      text: ' Control ⏵ '
      items:
        - type: back
          text: ' ⏴ Back '
    - type: menu
      text: ' Settings ⏵ '
      id: menu_submenu_settings
      items:
        - type: back
          text: ' ⏴ Back '
        - type: number
          text: ' Brightness '
          number: clockos_number_screen_brightness
        - type: number
          text: ' Screen timeout '
          number: clockos_number_display_timeout
        - type: command
          text: !lambda |-
            return std::string(" Rumble [") + (id(global_game_rumble) ? "ON" : "OFF") + "]";
          on_value:
            then:
              - if:
                  condition:
                    lambda: 'return id(global_game_rumble);'
                  then:
                    - switch.turn_off: switch_game_rumble
                  else:
                    - switch.turn_on: switch_game_rumble
        - type: command
          text: !lambda |-
            return std::string(" Sound [") + (id(global_game_sound) ? "ON" : "OFF") + "]";
          on_value:
            then:
              - if:
                  condition:
                    lambda: 'return id(global_game_sound);'
                  then:
                    - switch.turn_off: switch_game_sound
                  else:
                    - switch.turn_on: switch_game_sound
        - type: number
          text: ' Volume '
          number: clockos_number_beeper_volume
    - type: command
      text: ' Close '
      on_value:
        then:
          - display_menu.hide: main_menu
